use strict;
use warnings;
use mirrors;
our %detector;
our %configuration;
our %parameters;

use Getopt::Long;
use Math::Trig;

my $DEG=180/3.1415916;
my $DetectorMother="root";

my $DetectorName = 'det1_rich_dual_ionside';

#my $offset=70.9;

#my $offset_inner=40.3;

my $hittype="eic_rich";
#my $hittype="no";

my $Rout_a=((200.-120.)/(415.-250.))*(4.)+120.; 
my $Rout_l=((200.-120.)/(415.-250.))*(4.32)+120.; 


sub det1_rich_dual_ionside
{
 my $NUM  = 6;
 my $sector_start = -30;
 my $sector_angle = 60;
 my $sector_start_m = -27;
 my $sector_angle_m = 54;
 my $mir_dx = 145;
 my $mir_r = 289.9;
 my $mir_r_out = 290.;
 my $mir_z = -210.;
 my $mir_rot = asin($mir_dx/$mir_r)*$DEG;
 my @z    = (250+82.5,252,254.16,254.32+80.34);
 my @Rin1  = (10,10,10,10);
 my @Rout1 = (300,120,$Rout_a,$Rout_l);
 my @Rin2  = (10,10,10,10);
 my @Rout2 = (350,$Rout_a,$Rout_l,200);
 my @Dz   = (82.5,2,0.16,80.34);
 my @name = ("box","aeo_rad","shield","gas_rad"); 
 my @mother = ("$DetectorMother","$DetectorMother","$DetectorMother","$DetectorMother"); 
 my @mat  = ("MAT\_$DetectorName\_gas","MAT\_$DetectorName\_aerogel","acrylic_a","MAT\_$DetectorName\_gas",);
 my @color  = ("000000","880000","008880","008800");
 my @id  = ("no","id manual 1","no","id manual 2");
 my @rot  = (0,0,0,0);

 my @phdet_posz = (-21.7177,-18.9814,-17.3472,-16.5663,-16.3276,-17.2176,-18.9462,-21.9496,-24.2519,-22.8032,-20.3263,-19.0161,-18.4162,-18.3475,-19.2535,-20.3323,-22.0359,-23.6556,-26.4138,-24.5833,-22.2783,-21.0568,-20.6368,-20.6864,-20.9686,-22.4225,-24.3539,-26.2197,-29.7667,-28.4191,-26.1228,-24.2405,-22.925,-22.785,-22.7857,-23.1974,-24.299,-26.4342,-28.5273,-28.1,-31.4429,-30.5173,-28.2301,-26.8281,-25.787,-24.9921,-25.1769,-25.8093,-26.7054,-28.5937,-30.5819,-32.1848,-34.7204,-33.0888,-30.6279,-29.159,-28.0491,-27.6021,-27.6448,-28.4204,-29.299,-30.7418,-32.8625,-34.8432,-39.5,-37.3534,-35.1347,-33.119,-32.0093,-30.7346,-30.2894,-30.6833,-31,-31.9405,-33.3326,-35.0284,-37.3726,-38.0053,-41.4438,-40.6104,-38.0654,-36.2729,-34.7369,-33.8984,-33.6217,-33.6132,-34.1243,-34.5749,-35.9918,-38.2092,-40.0822,-41.4908,-45.4056,-43.288,-40.8407,-39.3138,-38.1244,-36.9701,-36.491,-36.5177,-37.2131,-37.5743,-39.2667,-40.9325,-43.0826,-45.4614,-50,-48.3434,-46.0564,-43.815,-42.6635,-41.3679,-40.3964,-39.7949,-39.959,-40.8597,-41.2071,-42.604,-44.1263,-46.2081,-48.766,-52.8361,-51.8947,-49.9869,-47.9386,-45.7953,-45.1466,-43.9918,-43.9431,-43.6016,-44.3315,-44.8694,-46.0131,-47.4713,-49.7036,-51.8452,-54.2452,-57.7213,-55.8327,-53.5166,-51.3525,-49.6098,-48.9847,-47.959,-47.8029,-47.697,-47.7794,-48.7461,-50.1595,-52.1837,-53.4366,-55.5627,-57.3225,-60.5385,-59.6478,-57.6436,-55.6756,-54.0088,-53.0856,-52.4164,-52.4981,-51.7979,-52.245,-53.3618,-54.4251,-55.5348,-57.3401,-58.9312,-60.0455,-60.5538,-58.692,-57.8273,-57.0231,-56.6022,-56.146,-56.3889,-56.4936,-57.4331,-58.1424,-58.9439,-60.2159);
 
 my @phdet_posx = (144.5,144.5,144.5,144.5,144.5,144.5,144.5,144.5,149.5,149.5,149.5,149.5,149.5,149.5,149.5,149.5,149.5,149.5,154.5,154.5,154.5,154.5,154.5,154.5,154.5,154.5,154.5,154.5,159.5,159.5,159.5,159.5,159.5,159.5,159.5,159.5,159.5,159.5,159.5,159.5,164.5,164.5,164.5,164.5,164.5,164.5,164.5,164.5,164.5,164.5,164.5,164.5,169.5,169.5,169.5,169.5,169.5,169.5,169.5,169.5,169.5,169.5,169.5,169.5,174.5,174.5,174.5,174.5,174.5,174.5,174.5,174.5,174.5,174.5,174.5,174.5,174.5,174.5,179.5,179.5,179.5,179.5,179.5,179.5,179.5,179.5,179.5,179.5,179.5,179.5,179.5,179.5,184.5,184.5,184.5,184.5,184.5,184.5,184.5,184.5,184.5,184.5,184.5,184.5,184.5,184.5,189.5,189.5,189.5,189.5,189.5,189.5,189.5,189.5,189.5,189.5,189.5,189.5,189.5,189.5,189.5,194.5,194.5,194.5,194.5,194.5,194.5,194.5,194.5,194.5,194.5,194.5,194.5,194.5,194.5,194.5,194.5,199.5,199.5,199.5,199.5,199.5,199.5,199.5,199.5,199.5,199.5,199.5,199.5,199.5,199.5,199.5,199.5,204.5,204.5,204.5,204.5,204.5,204.5,204.5,204.5,204.5,204.5,204.5,204.5,204.5,204.5,204.5,204.5,209.5,209.5,209.5,209.5,209.5,209.5,209.5,209.5,209.5,209.5,209.5,209.5);

 my @phdet_posy = (-17.5,-12.5,-7.5,-2.5,2.5,7.5,12.5,17.5,-22.5,-17.5,-12.5,-7.5,-2.5,2.5,7.5,12.5,17.5,22.5,-22.5,-17.5,-12.5,-7.5,-2.5,2.5,7.5,12.5,17.5,22.5,-27.5,-22.5,-17.5,-12.5,-7.5,-2.5,2.5,7.5,12.5,17.5,22.5,27.5,-27.5,-22.5,-17.5,-12.5,-7.5,-2.5,2.5,7.5,12.5,17.5,22.5,27.5,-27.5,-22.5,-17.5,-12.5,-7.5,-2.5,2.5,7.5,12.5,17.5,22.5,27.5,-32.5,-27.5,-22.5,-17.5,-12.5,-7.5,-2.5,2.5,7.5,12.5,17.5,22.5,27.5,32.5,-32.5,-27.5,-22.5,-17.5,-12.5,-7.5,-2.5,2.5,7.5,12.5,17.5,22.5,27.5,32.5,-32.5,-27.5,-22.5,-17.5,-12.5,-7.5,-2.5,2.5,7.5,12.5,17.5,22.5,27.5,32.5,-37.5,-32.5,-27.5,-22.5,-17.5,-12.5,-7.5,-2.5,2.5,7.5,12.5,17.5,22.5,27.5,32.5,-37.5,-32.5,-27.5,-22.5,-17.5,-12.5,-7.5,-2.5,2.5,7.5,12.5,17.5,22.5,27.5,32.5,37.5,-37.5,-32.5,-27.5,-22.5,-17.5,-12.5,-7.5,-2.5,2.5,7.5,12.5,17.5,22.5,27.5,32.5,37.5,-37.5,-32.5,-27.5,-22.5,-17.5,-12.5,-7.5,-2.5,2.5,7.5,12.5,17.5,22.5,27.5,32.5,37.5,-27.5,-22.5,-17.5,-12.5,-7.5,-2.5,2.5,7.5,12.5,17.5,22.5,27.5);

 my @phdet_posz1 = (-19.1013,-25.4713,-27.4375,-27.4901,-27.8028,-27.4042,-27.4941,-26.8238,-25.6219,-19.025,-25.579,-28.3033,-30.7911,-30.4141,-30.8957,-30.9054,-30.8455,-30.0517,-28.2431,-23.8038,-21.3833,-28.0893,-31.0951,-33.7934,-33.7068,-34.9713,-34.2655,-34.2268,-33.6498,-31.1591,-29.3903,-23.37,-29.1953,-32.7935,-35.1425,-37.72,-38.1521,-39.0964,-39.1739,-37.2271,-37.522,-34.5898,-32.5758,-31.0425,-34.2911,-35.5574,-38.8793,-39.9285,-41.1349,-41.0312,-41.2326,-40.8762,-40.1833,-38.9463,-35.7264,-34.4265,-31.421,-37.0838,-39.4419,-42.1983,-42.4781,-43.4383,-43.3073,-43.1951,-43.52,-43.0518,-42.4918,-39.4364,-37.2865,-32.1595,-38.668,-41.3763,-44.4772,-45.0386,-46.0881,-46.4339,-45.9926,-45.8245,-45.9882,-46.5638,-46.2052,-45.018,-41.9683,-40.4169,-43.9017,-46.9324,-49.1539,-48.3111,-48.7612,-48.739,-49.0769,-48.6152,-48.2836,-49.1114,-48.6674,-48.6385,-46.6524,-45.0696,-51.2941,-48.9085,-50.2179,-51.2831,-51.9188,-51.3501,-51.8915,-51.7755,-51.4737,-51.9227,-52.4367,-51.7238,-50.871,-50.5253,-48.3419,-52.4612,-52.7151,-52.8598,-54.2668,-55.5983,-54.8466,-54.3365,-54.593,-54.7374,-54.1332,-54.7089,-55.0632,-55.2456,-55.0136,-54.3212,-53.0685,-53.8994,-51.4891,-56.8126,-57.6979,-58.2959,-58.4675,-57.6862,-58.0769,-57.8553,-57.4122,-57.9052,-58.0182,-58.6716,-59.1709,-57.9714,-56.9898,-52.7961,-53.5748,-60.7697,-60.5782,-61.6349,-62.1706,-61.6014,-61.6055,-61.431,-60.6319,-61.7978,-61.8451,-62.0809,-61.7531,-60.2153,-61.3655,-54.8318,-62.648,-63.5486,-62.7556,-62.8154,-63.4228,-63.089,-63.8043,-64.7006,-63.9126,-64.7043,-63.3328,-62.6137,-62.8233,-62.7814,-63.4503,-59.7203,-63.9496,-64.936,-63.6189,-62.9728,-63.4284,-64.0883,-62.5993,-64.1751,-63.664,-63.1552,-63.4964,-64.6588,-63.2);
 
 my @phdet_posx1 = (144.5,144.5,144.5,144.5,144.5,144.5,144.5,144.5,144.5,144.5,149.5,149.5,149.5,149.5,149.5,149.5,149.5,149.5,149.5,149.5,154.5,154.5,154.5,154.5,154.5,154.5,154.5,154.5,154.5,154.5,154.5,154.5,159.5,159.5,159.5,159.5,159.5,159.5,159.5,159.5,159.5,159.5,159.5,159.5,164.5,164.5,164.5,164.5,164.5,164.5,164.5,164.5,164.5,164.5,164.5,164.5,169.5,169.5,169.5,169.5,169.5,169.5,169.5,169.5,169.5,169.5,169.5,169.5,169.5,169.5,174.5,174.5,174.5,174.5,174.5,174.5,174.5,174.5,174.5,174.5,174.5,174.5,174.5,174.5,179.5,179.5,179.5,179.5,179.5,179.5,179.5,179.5,179.5,179.5,179.5,179.5,179.5,179.5,184.5,184.5,184.5,184.5,184.5,184.5,184.5,184.5,184.5,184.5,184.5,184.5,184.5,184.5,184.5,184.5,189.5,189.5,189.5,189.5,189.5,189.5,189.5,189.5,189.5,189.5,189.5,189.5,189.5,189.5,189.5,189.5,194.5,194.5,194.5,194.5,194.5,194.5,194.5,194.5,194.5,194.5,194.5,194.5,194.5,194.5,194.5,194.5,199.5,199.5,199.5,199.5,199.5,199.5,199.5,199.5,199.5,199.5,199.5,199.5,199.5,199.5,199.5,199.5,204.5,204.5,204.5,204.5,204.5,204.5,204.5,204.5,204.5,204.5,204.5,204.5,204.5,204.5,204.5,204.5,209.5,209.5,209.5,209.5,209.5,209.5,209.5,209.5,209.5,209.5,209.5,209.5,209.5);
 
 my @phdet_posy1 = (-22.5,-17.5,-12.5,-7.5,-2.5,2.5,7.5,12.5,17.5,22.5,-22.5,-17.5,-12.5,-7.5,-2.5,2.5,7.5,12.5,17.5,22.5,-27.5,-22.5,-17.5,-12.5,-7.5,-2.5,2.5,7.5,12.5,17.5,22.5,27.5,-27.5,-22.5,-17.5,-12.5,-7.5,-2.5,2.5,7.5,12.5,17.5,22.5,27.5,-27.5,-22.5,-17.5,-12.5,-7.5,-2.5,2.5,7.5,12.5,17.5,22.5,27.5,-32.5,-27.5,-22.5,-17.5,-12.5,-7.5,-2.5,2.5,7.5,12.5,17.5,22.5,27.5,32.5,-32.5,-27.5,-22.5,-17.5,-12.5,-7.5,-2.5,2.5,7.5,12.5,17.5,22.5,27.5,32.5,-32.5,-27.5,-22.5,-17.5,-12.5,-7.5,-2.5,2.5,7.5,12.5,17.5,22.5,27.5,32.5,-37.5,-32.5,-27.5,-22.5,-17.5,-12.5,-7.5,-2.5,2.5,7.5,12.5,17.5,22.5,27.5,32.5,37.5,-37.5,-32.5,-27.5,-22.5,-17.5,-12.5,-7.5,-2.5,2.5,7.5,12.5,17.5,22.5,27.5,32.5,37.5,-37.5,-32.5,-27.5,-22.5,-17.5,-12.5,-7.5,-2.5,2.5,7.5,12.5,17.5,22.5,27.5,32.5,37.5,-37.5,-32.5,-27.5,-22.5,-17.5,-12.5,-7.5,-2.5,2.5,7.5,12.5,17.5,22.5,27.5,32.5,37.5,-37.5,-32.5,-27.5,-22.5,-17.5,-12.5,-7.5,-2.5,2.5,7.5,12.5,17.5,22.5,27.5,32.5,37.5,-27.5,-22.5,-17.5,-12.5,-7.5,-2.5,2.5,7.5,12.5,17.5,22.5,27.5,32.5);

 my @phdet_sph_posz = (-39.8816,-39.1429,-38.5,-37.9533,-37.5,-37.5,-37.5,-37.5,-37.9878,-38.5,-39.1774,-39.8288,-39.8974,-39.2128,-38.5,-38.3182,-37.5,-37.5,-37.5,-37.5,-38.1933,-38.5,-39.3169,-39.8889,-40.2363,-39.4394,-38.5854,-38.4868,-37.9079,-37.5143,-37.5116,-37.8902,-38.4833,-38.6447,-39.4744,-40.1957,-40.544,-39.6892,-39.25,-38.5133,-38.5,-38.4014,-38.4605,-38.5,-38.5256,-39.2971,-39.6176,-40.5244,-42.0248,-41.0732,-40.3526,-39.6047,-39.3261,-38.8418,-38.5652,-38.5976,-38.7278,-39.3095,-39.6728,-40.3875,-41.0682,-42.0672,-42.8929,-41.8614,-40.9891,-40.3873,-39.8034,-39.5244,-39.5,-39.5,-39.5147,-39.8816,-40.3831,-40.925,-41.7706,-42.7603,-43.6143,-42.7135,-41.8521,-41.2931,-40.6972,-40.4268,-40.2746,-40.2753,-40.4589,-40.7078,-41.2179,-41.9219,-42.7051,-43.7055,-44.7877,-43.7,-42.9865,-42.1977,-41.7208,-41.5,-41.3395,-41.25,-41.4277,-41.8924,-42.2439,-42.9177,-43.7317,-44.6935,-47.1707,-45.9098,-44.9598,-44.129,-43.4425,-42.9632,-42.7024,-42.537,-42.529,-42.7079,-42.9878,-43.4315,-44,-44.9535,-45.94,-47.0851,-48.4783,-47.3364,-46.3452,-45.5,-44.9111,-44.2708,-44.0802,-43.94,-43.8951,-44.0195,-44.2778,-44.9941,-45.4518,-46.3132,-47.34,-48.4577,-50.0741,-48.8415,-47.9337,-47.1579,-46.5,-45.9545,-45.5141,-45.3837,-45.3286,-45.5759,-45.9706,-46.3718,-47.0385,-47.8297,-48.9684,-49.981,-51.8222,-50.6481,-49.7245,-48.6932,-47.9651,-47.6398,-47.3116,-47.0238,-47,-47.2439,-47.6026,-48.1707,-48.7421,-49.6136,-50.5816,-51.7603,-55.1582,-53.7414,-52.5909,-51.5326,-50.525,-50.1667,-49.5723,-49.2901,-49.0046,-49.0143,-49.2204,-49.4643,-50.0747,-50.7062,-51.7093,-52.6707,-53.8085,-55.2407,-57.2619,-55.9118,-54.6648,-53.5816,-52.8034,-52.179,-51.6978,-51.3382,-51.142,-51.0595,-51.3182,-51.7551,-52.0402,-52.7955,-53.7208,-54.6358,-55.9651,-57.3785,-59.8333,-58.3283,-57.0309,-55.9773,-55.3462,-54.5241,-54,-53.6585,-53.3585,-53.325,-53.5714,-53.8295,-54.5095,-55.1344,-56.1275,-57.2053,-58.3901,-59.8194,-62.4579,-61.1463,-59.753,-58.5351,-57.7073,-57.006,-56.5,-56.1436,-55.8133,-56,-56.1923,-56.5435,-56.9706,-57.6354,-58.5392,-59.5659,-61.0269,-62.2766,-66.8412,-65.4545,-63.8737,-62.5202,-61.2241,-60.5825,-59.7526,-59.2069,-58.8176,-58.6882,-58.6667,-59.0507,-59.2531,-59.8505,-60.5,-61.5111,-62.3471,-63.7475,-65.5,-67.0567,-70.3222,-68.5103,-66.9419,-65.5562,-64.3901,-63.5543,-62.7184,-62.0476,-61.9023,-61.7021,-61.5971,-61.8269,-62.1622,-62.9605,-63.6319,-64.5619,-65.6222,-67.0833,-68.477,-70.3659,-73.5594,-71.9483,-70.5353,-68.7299,-67.7292,-66.8232,-66.1098,-65.5,-65.2791,-65.1304,-64.913,-65.0714,-65.5455,-66.06,-66.7696,-67.5721,-68.8654,-70.3839,-71.8271,-73.6304,-77.3154,-75.6429,-74.1549,-72.8298,-71.5101,-70.18,-69.5316,-68.9486,-68.569,-68.2791,-68.3804,-68.622,-69.0566,-69.4756,-70.445,-71.2412,-72.4905,-74.0161,-75.8071,-77.4307); 

 my @phdet_sph_posx = (144.5,144.5,144.5,144.5,144.5,144.5,144.5,144.5,144.5,144.5,144.5,144.5,149.5,149.5,149.5,149.5,149.5,149.5,149.5,149.5,149.5,149.5,149.5,149.5,154.5,154.5,154.5,154.5,154.5,154.5,154.5,154.5,154.5,154.5,154.5,154.5,159.5,159.5,159.5,159.5,159.5,159.5,159.5,159.5,159.5,159.5,159.5,159.5,164.5,164.5,164.5,164.5,164.5,164.5,164.5,164.5,164.5,164.5,164.5,164.5,164.5,164.5,169.5,169.5,169.5,169.5,169.5,169.5,169.5,169.5,169.5,169.5,169.5,169.5,169.5,169.5,174.5,174.5,174.5,174.5,174.5,174.5,174.5,174.5,174.5,174.5,174.5,174.5,174.5,174.5,179.5,179.5,179.5,179.5,179.5,179.5,179.5,179.5,179.5,179.5,179.5,179.5,179.5,179.5,184.5,184.5,184.5,184.5,184.5,184.5,184.5,184.5,184.5,184.5,184.5,184.5,184.5,184.5,184.5,184.5,189.5,189.5,189.5,189.5,189.5,189.5,189.5,189.5,189.5,189.5,189.5,189.5,189.5,189.5,189.5,189.5,194.5,194.5,194.5,194.5,194.5,194.5,194.5,194.5,194.5,194.5,194.5,194.5,194.5,194.5,194.5,194.5,199.5,199.5,199.5,199.5,199.5,199.5,199.5,199.5,199.5,199.5,199.5,199.5,199.5,199.5,199.5,199.5,204.5,204.5,204.5,204.5,204.5,204.5,204.5,204.5,204.5,204.5,204.5,204.5,204.5,204.5,204.5,204.5,204.5,204.5,209.5,209.5,209.5,209.5,209.5,209.5,209.5,209.5,209.5,209.5,209.5,209.5,209.5,209.5,209.5,209.5,209.5,209.5,214.5,214.5,214.5,214.5,214.5,214.5,214.5,214.5,214.5,214.5,214.5,214.5,214.5,214.5,214.5,214.5,214.5,214.5,219.5,219.5,219.5,219.5,219.5,219.5,219.5,219.5,219.5,219.5,219.5,219.5,219.5,219.5,219.5,219.5,219.5,219.5,224.5,224.5,224.5,224.5,224.5,224.5,224.5,224.5,224.5,224.5,224.5,224.5,224.5,224.5,224.5,224.5,224.5,224.5,224.5,224.5,229.5,229.5,229.5,229.5,229.5,229.5,229.5,229.5,229.5,229.5,229.5,229.5,229.5,229.5,229.5,229.5,229.5,229.5,229.5,229.5,234.5,234.5,234.5,234.5,234.5,234.5,234.5,234.5,234.5,234.5,234.5,234.5,234.5,234.5,234.5,234.5,234.5,234.5,234.5,234.5,239.5,239.5,239.5,239.5,239.5,239.5,239.5,239.5,239.5,239.5,239.5,239.5,239.5,239.5,239.5,239.5,239.5,239.5,239.5,239.5);

 my @phdet_sph_posy = (-27.5,-22.5,-17.5,-12.5,-7.5,-2.5,2.5,7.5,12.5,17.5,22.5,27.5,-27.5,-22.5,-17.5,-12.5,-7.5,-2.5,2.5,7.5,12.5,17.5,22.5,27.5,-27.5,-22.5,-17.5,-12.5,-7.5,-2.5,2.5,7.5,12.5,17.5,22.5,27.5,-27.5,-22.5,-17.5,-12.5,-7.5,-2.5,2.5,7.5,12.5,17.5,22.5,27.5,-32.5,-27.5,-22.5,-17.5,-12.5,-7.5,-2.5,2.5,7.5,12.5,17.5,22.5,27.5,32.5,-32.5,-27.5,-22.5,-17.5,-12.5,-7.5,-2.5,2.5,7.5,12.5,17.5,22.5,27.5,32.5,-32.5,-27.5,-22.5,-17.5,-12.5,-7.5,-2.5,2.5,7.5,12.5,17.5,22.5,27.5,32.5,-32.5,-27.5,-22.5,-17.5,-12.5,-7.5,-2.5,2.5,7.5,12.5,17.5,22.5,27.5,32.5,-37.5,-32.5,-27.5,-22.5,-17.5,-12.5,-7.5,-2.5,2.5,7.5,12.5,17.5,22.5,27.5,32.5,37.5,-37.5,-32.5,-27.5,-22.5,-17.5,-12.5,-7.5,-2.5,2.5,7.5,12.5,17.5,22.5,27.5,32.5,37.5,-37.5,-32.5,-27.5,-22.5,-17.5,-12.5,-7.5,-2.5,2.5,7.5,12.5,17.5,22.5,27.5,32.5,37.5,-37.5,-32.5,-27.5,-22.5,-17.5,-12.5,-7.5,-2.5,2.5,7.5,12.5,17.5,22.5,27.5,32.5,37.5,-42.5,-37.5,-32.5,-27.5,-22.5,-17.5,-12.5,-7.5,-2.5,2.5,7.5,12.5,17.5,22.5,27.5,32.5,37.5,42.5,-42.5,-37.5,-32.5,-27.5,-22.5,-17.5,-12.5,-7.5,-2.5,2.5,7.5,12.5,17.5,22.5,27.5,32.5,37.5,42.5,-42.5,-37.5,-32.5,-27.5,-22.5,-17.5,-12.5,-7.5,-2.5,2.5,7.5,12.5,17.5,22.5,27.5,32.5,37.5,42.5,-42.5,-37.5,-32.5,-27.5,-22.5,-17.5,-12.5,-7.5,-2.5,2.5,7.5,12.5,17.5,22.5,27.5,32.5,37.5,42.5,-47.5,-42.5,-37.5,-32.5,-27.5,-22.5,-17.5,-12.5,-7.5,-2.5,2.5,7.5,12.5,17.5,22.5,27.5,32.5,37.5,42.5,47.5,-47.5,-42.5,-37.5,-32.5,-27.5,-22.5,-17.5,-12.5,-7.5,-2.5,2.5,7.5,12.5,17.5,22.5,27.5,32.5,37.5,42.5,47.5,-47.5,-42.5,-37.5,-32.5,-27.5,-22.5,-17.5,-12.5,-7.5,-2.5,2.5,7.5,12.5,17.5,22.5,27.5,32.5,37.5,42.5,47.5,-47.5,-42.5,-37.5,-32.5,-27.5,-22.5,-17.5,-12.5,-7.5,-2.5,2.5,7.5,12.5,17.5,22.5,27.5,32.5,37.5,42.5,47.5);
 
 for(my $n=1; $n<=$NUM; $n++)
 {
     my $rot_phi = $sector_angle*($n -1);

     my %detector;
     
     %detector=init_det();
     $detector{"name"}        = "$DetectorName\_$name[0]_$n";
     $detector{"mother"}      = "$mother[0]";
     $detector{"description"} = "$DetectorName\_$name[0]_$n";
     $detector{"pos"}        = "0*cm 0*cm $z[0]*cm";
     $detector{"rotation"}   = "$rot[0]*deg 0*deg $rot_phi*deg";
     $detector{"color"}      = "$color[3]"; 
     $detector{"type"}       = "Cons";
     $detector{"dimensions"} = "$Rin1[0]*cm $Rout1[0]*cm $Rin2[0]*cm $Rout2[0]*cm $Dz[0]*cm $sector_start*deg $sector_angle*deg";
     $detector{"material"}   = $mat[0];
     $detector{"mfield"}     = "no";
     $detector{"ncopy"}      = 1;
     $detector{"pMany"}       = 1;
     $detector{"exist"}       = 1;
     $detector{"visible"}     = 1;
     #$detector{"style"}       = 1;
     $detector{"sensitivity"} = "$hittype";
     $detector{"hit_type"}    = "$hittype";
     $detector{"identifiers"} = "id manual 2$n";
     print_det(\%configuration, \%detector);


     %detector=init_det();
     $detector{"name"}        = "$DetectorName\_$name[1]_$n";
     $detector{"mother"}      = "$DetectorName\_$name[0]_$n";
     #$detector{"mother"}      = "$mother[1]" ;
     $detector{"description"} = "$DetectorName\_$name[1]_$n";
     #$detector{"pos"}        = "0*cm 0*cm $z[1]*cm";
     $detector{"pos"}        = "0*cm 0*cm -80.5*cm";
     #$detector{"rotation"}   = "$rot[1]*deg 0*deg $rot_phi*deg";
     $detector{"rotation"}   = "$rot[1]*deg 0*deg 0*deg";
     $detector{"color"}      = "$color[1]"; 
     $detector{"type"}       = "Cons";
     $detector{"dimensions"} = "$Rin1[1]*cm $Rout1[1]*cm $Rin2[1]*cm $Rout2[1]*cm $Dz[1]*cm $sector_start*deg $sector_angle*deg";
     $detector{"material"}   = $mat[1];
     $detector{"mfield"}     = "no";
     $detector{"ncopy"}      = 1;
     $detector{"pMany"}       = 1;
     $detector{"exist"}       = 1;
     $detector{"visible"}     = 1;
     $detector{"style"}       = 0;
     $detector{"sensitivity"} = "$hittype";
     $detector{"hit_type"}    = "$hittype";
     #$detector{"identifiers"} = "$id[1]";
     $detector{"identifiers"} = "id manual 1$n";
     print_det(\%configuration, \%detector);

     %detector=init_det();
     $detector{"name"}        = "$DetectorName\_$name[2]_$n";
     $detector{"mother"}      = "$DetectorName\_$name[0]_$n";
     #$detector{"mother"}      = "$mother[1]" ;
     $detector{"description"} = "$DetectorName\_$name[2]_$n";
     #$detector{"pos"}        = "0*cm 0*cm $z[1]*cm";
     $detector{"pos"}        = "0*cm 0*cm -78.34*cm";
     #$detector{"pos"}        = "0*cm 0*cm -8.34*cm";
     #$detector{"rotation"}   = "$rot[1]*deg 0*deg $rot_phi*deg";
     $detector{"rotation"}   = "$rot[1]*deg 0*deg 0*deg";
     $detector{"color"}      = "$color[2]"; 
     $detector{"type"}       = "Cons";
     $detector{"dimensions"} = "$Rin1[2]*cm $Rout1[2]*cm $Rin2[2]*cm $Rout2[2]*cm $Dz[2]*cm $sector_start*deg $sector_angle*deg";
     $detector{"material"}   = $mat[2];
     $detector{"mfield"}     = "no";
     $detector{"ncopy"}      = 1;
     $detector{"pMany"}       = 1;
     $detector{"exist"}       = 1;
     $detector{"visible"}     = 1;
     $detector{"style"}       = 1;
     $detector{"sensitivity"} = "$hittype";
     $detector{"hit_type"}    = "$hittype";
     #$detector{"identifiers"} = "$id[1]";
     $detector{"identifiers"} = "id manual 7$n";
     print_det(\%configuration, \%detector);

     %detector=init_det();
     $detector{"name"}        = "prova_$n";
     $detector{"mother"}      = "$DetectorName\_$name[0]_$n";
     #$detector{"mother"}      = "$mother[1]" ;
     $detector{"description"} = "prova_$n";
     #$detector{"pos"}        = "0*cm 0*cm $z[1]*cm";
     $detector{"pos"}        = "0*cm 0*cm 38.34*cm";
     #$detector{"rotation"}   = "$rot[1]*deg 0*deg $rot_phi*deg";
     $detector{"rotation"}   = "$rot[1]*deg 0*deg 0*deg";
     $detector{"color"}      = "$color[0]"; 
     $detector{"type"}       = "Cons";
     $detector{"dimensions"} = "$Rin1[2]*cm $Rout1[2]*cm $Rin2[2]*cm $Rout2[2]*cm $Dz[2]*cm $sector_start*deg $sector_angle*deg";
     $detector{"material"}   = "Air_Opt";
     $detector{"mfield"}     = "no";
     $detector{"ncopy"}      = 1;
     $detector{"pMany"}       = 1;
     $detector{"exist"}       = 0;
     $detector{"visible"}     = 1;
     $detector{"style"}       = 1;
     $detector{"sensitivity"} = "$hittype";
     $detector{"hit_type"}    = "$hittype";
     #$detector{"identifiers"} = "$id[1]";
     $detector{"identifiers"} = "id manual 8$n";
     print_det(\%configuration, \%detector);

     %detector=init_det();
     $detector{"name"}        = "prova1_$n";
     $detector{"mother"}      = "$DetectorName\_$name[0]_$n";
     #$detector{"mother"}      = "$mother[1]" ;
     $detector{"description"} = "prova1_$n";
     #$detector{"pos"}        = "0*cm 0*cm $z[1]*cm";
     $detector{"pos"}        = "0*cm 0*cm -38.34*cm";
     #$detector{"rotation"}   = "$rot[1]*deg 0*deg $rot_phi*deg";
     $detector{"rotation"}   = "$rot[1]*deg 0*deg 0*deg";
     $detector{"color"}      = "$color[0]"; 
     $detector{"type"}       = "Cons";
     $detector{"dimensions"} = "$Rin1[2]*cm $Rout1[2]*cm $Rin2[2]*cm $Rout2[2]*cm $Dz[2]*cm $sector_start*deg $sector_angle*deg";
     $detector{"material"}   = "Air_Opt";
     $detector{"mfield"}     = "no";
     $detector{"ncopy"}      = 1;
     $detector{"pMany"}       = 1;
     $detector{"exist"}       = 0;
     $detector{"visible"}     = 1;
     $detector{"style"}       = 1;
     $detector{"sensitivity"} = "$hittype";
     $detector{"hit_type"}    = "$hittype";
     #$detector{"identifiers"} = "$id[1]";
     $detector{"identifiers"} = "id manual 9$n";
     print_det(\%configuration, \%detector);


=pod
     #%detector=init_det();
     $detector{"name"}        = "$DetectorName\_$name[2]_$n";
     $detector{"mother"}        = "$DetectorName\_$name[0]_$n";
     #$detector{"mother"}      = "$mother[2]" ;
     $detector{"description"} = "$DetectorName\_$name[2]_$n";
     #$detector{"pos"}        = "0*cm 0*cm $z[2]*cm";
     $detector{"pos"}        = "0*cm 0*cm 2*cm";
     #$detector{"rotation"}   = "$rot[2]*deg 0*deg $rot_phi*deg";
     $detector{"rotation"}   = "$rot[2]*deg 0*deg 0*deg";
     $detector{"color"}      = "$color[2]"; 
     $detector{"type"}       = "Cons";
     $detector{"dimensions"} = "$Rin1[2]*cm $Rout1[2]*cm $Rin2[2]*cm $Rout2[2]*cm $Dz[2]*cm $sector_start*deg $sector_angle*deg";
     $detector{"material"}   = $mat[2];
     $detector{"mfield"}     = "no";
     $detector{"ncopy"}      = 1;
     $detector{"pMany"}       = 1;
     $detector{"exist"}       = 1;
     $detector{"visible"}     = 1;
     $detector{"style"}       = 0;
     $detector{"sensitivity"} = "$hittype";
     $detector{"hit_type"}    = "$hittype";
     #$detector{"identifiers"} = "$id[2]";
     $detector{"identifiers"} = "id manual 2$n";
     print_det(\%configuration, \%detector);
=cut

	
     %detector = init_det();
     $detector{"name"}        = "mirror_$n";
     $detector{"mother"}      = "$DetectorName\_box_$n";
     #$detector{"mother"}      = "$DetectorMother";
     $detector{"description"} = "Spherical mirror";
     $detector{"pos"}         = "$mir_dx*cm 0*cm $mir_z*cm";
     #$detector{"pos"}         = "0*cm 0*cm 80*cm";
     $detector{"rotation"}    = "0*deg $mir_rot*deg 0*deg";
     $detector{"color"}       = "D8D8D8";
     $detector{"type"}        = "Sphere";
     $detector{"dimensions"}  = "$mir_r*cm $mir_r_out*cm $sector_start*deg $sector_angle*deg 2.5*deg 40*deg";
     $detector{"material"}    = "Aluminum";
     $detector{"ncopy"}       = 1;
     $detector{"pMany"}       = 1;
     $detector{"exist"}       = 1;
     $detector{"visible"}     = 1;
     $detector{"style"}       = 1;  
     $detector{"sensitivity"} = "mirror: spherical_mirror";
     $detector{"hit_type"}    = "mirror";
     $detector{"identifiers"} = "no";
     print_det(\%configuration, \%detector);

=pod
     #my @photondet_pos  = ( 10.0, 0.0, 251.0);
     my @photondet_pos  = ( 0.0, 0.0, -58.0);
     %detector=init_det();
     $detector{"name"} = "photondet_$n";
     $detector{"mother"} = "$DetectorName\_box_$n";
     #$detector{"mother"} = "$DetectorMother";
     $detector{"description"} = "photondet_name_$n";
     $detector{"pos"} = "$photondet_pos[0]*cm $photondet_pos[1]*cm $photondet_pos[2]*cm";
     $detector{"rotation"} = "0*deg 10*deg 0*deg";
     $detector{"color"} = "0000A0";
     $detector{"type"} = "Cons";
     #$detector{"dimensions"} = "100*cm 160*cm 100*cm 160*cm 1*cm -15*deg 30*deg"; #small sector
     #$detector{"dimensions"} = "130*cm 220*cm 130*cm 220*cm 1*cm -20*deg 40*deg"; #plane sector
     $detector{"dimensions"} = "145*cm 200*cm 100*cm 200*cm 1*cm -15*deg 30*deg";
     #$detector{"type"}        = "Sphere";
     #$detector{"dimensions"}  = "299*cm 300*cm 0*deg 360*deg 25*deg 40*deg";
     $detector{"material"} = $mat[0];
     $detector{"mfield"} = "no";
     $detector{"ncopy"}      = 1;
     $detector{"pMany"}       = 1;
     $detector{"exist"}       = 1;
     $detector{"visible"}     = 1;
     $detector{"style"}       = 1;
     $detector{"sensitivity"} = "$hittype";
     $detector{"hit_type"}    = "$hittype";
     $detector{"identifiers"} = "id manual 4$n";
     print_det(\%configuration, \%detector);
=cut


     my %detector = init_det();
     $detector{"name"}        = "det_mirror_$n";
     #$detector{"mother"}      = "$DetectorName\_gas_rad_$n";
     $detector{"mother"}        = "$DetectorName\_$name[0]_$n";
     $detector{"description"} = "det spherical mirror";
     $detector{"pos"}         = "$mir_dx*cm 0*cm -197*cm";
     #$detector{"pos"}         = "0*cm 0*cm 80*cm";
     $detector{"rotation"}    = "0*deg $mir_rot*deg 0*deg";
     $detector{"color"}       = "fcc02d";
     $detector{"type"}        = "Sphere";
     $detector{"dimensions"}  = "159.9*cm 160*cm -20*deg 40*deg 30*deg 24*deg";
     $detector{"material"}    = "Air_Opt";
     $detector{"ncopy"}       = 1;
     $detector{"pMany"}       = 1;
     $detector{"exist"}       = 0;
     $detector{"visible"}     = 1;
     $detector{"style"}       = 1;  
     $detector{"sensitivity"} = "$hittype";
     $detector{"hit_type"}    = "$hittype";
     $detector{"identifiers"} = "id manual 4$n";
     print_det(\%configuration, \%detector);
=pod
     my %detector = init_det();
     $detector{"name"}        = "det_mirror_back_$n";
     #$detector{"mother"}      = "$DetectorName\_gas_rad_$n";
     $detector{"mother"}        = "$DetectorName\_$name[0]_$n";
     $detector{"description"} = "back spherical mirror";
     $detector{"pos"}         = "$mir_dx*cm 0*cm -197*cm";
     #$detector{"pos"}         = "0*cm 0*cm 80*cm";
     $detector{"rotation"}    = "0*deg $mir_rot*deg 0*deg";
     $detector{"color"}       = "B18904";
     $detector{"type"}        = "Sphere";
     $detector{"dimensions"}  = "159.8*cm 159.9*cm -20*deg 40*deg 30*deg 24*deg";
     $detector{"material"}    = "Aluminum";
     $detector{"ncopy"}       = 1;
     $detector{"pMany"}       = 1;
     $detector{"exist"}       = 0;
     $detector{"visible"}     = 1;
     $detector{"style"}       = 1;  
     $detector{"sensitivity"} = "$hittype";
     $detector{"hit_type"}    = "$hittype";
     $detector{"identifiers"} = "no";
     print_det(\%configuration, \%detector);
=cut


     
     for(my $t=0; $t<=$#phdet_sph_posx; $t++){  

	 my $zz = $phdet_sph_posz[$t];
	 my $xx = $phdet_sph_posx[$t];
	 my $yy = $phdet_sph_posy[$t];
=pod
	 if($xx>100. && $xx<200.){
	     $zz = $zz +4.5;
	 }
=cut
=pod
	 if($xx<155.){
	     $zz = $zz -15;
	 }
	 if($xx<165. && $xx>155.){
	     $zz = $zz -16;
	 }
	 if($xx>=165.){
	     $zz = $zz -10;
	 }
=cut
	 
	 if($xx>140. && $xx<200.){
	 %detector = init_det();
	 $detector{"name"}        = "phdet_$n*1000+$t";
	 $detector{"mother"}        = "$DetectorName\_$name[0]_$n";
	 $detector{"description"} = "det_tile_$t";
	 $detector{"pos"}         = "$xx*cm $yy*cm $zz*cm";
	 $detector{"rotation"}    = "0*deg 0*deg 0*deg";
	 $detector{"color"}       = "fcc02d";
	 $detector{"type"}        = "Box";
	 #$detector{"dimensions"}  = "2.5*cm 2.5*cm 0.5*cm";
	 $detector{"dimensions"}  = "2.5*cm 2.5*cm 0.05*cm";
	 $detector{"material"}    = "Air_Opt";
	 $detector{"ncopy"}       = 1;
	 $detector{"pMany"}       = 1;
	 $detector{"exist"}       = 1;
	 $detector{"visible"}     = 1;
	 $detector{"style"}       = 1;  
	 $detector{"sensitivity"} = "$hittype";
	 $detector{"hit_type"}    = "$hittype";
	 $detector{"identifiers"} = "id manual 4$n";
	 print_det(\%configuration, \%detector);
	 
	 my $posz1 = $phdet_posz[$t] -0.5;
	 
	 %detector = init_det();
	 $detector{"name"}        = "phdetback_$n*1000+$t";
	 $detector{"mother"}        = "phdet_$n*1000+$t";
	 $detector{"description"} = "det_tileback_$t";
	 $detector{"pos"}         = "0*cm 0*cm -0.0495*cm";
	 $detector{"rotation"}    = "0*deg 0*deg 0*deg";
	 $detector{"color"}       = "ff4000";
	 $detector{"type"}        = "Box";
	 $detector{"dimensions"}  = "2.5*cm 2.5*cm 0.001*cm";
	 $detector{"material"}    = "Aluminum";
	 $detector{"ncopy"}       = 1;
	 $detector{"pMany"}       = 1;
	 $detector{"exist"}       = 1;
	 $detector{"visible"}     = 1;
	 $detector{"style"}       = 1;  
	 $detector{"sensitivity"} = "$hittype";
	 $detector{"hit_type"}    = "$hittype";
	 $detector{"identifiers"} = "no";
	 print_det(\%configuration, \%detector);
	 }
     }

 }
}
